---
// Enhanced Left-side scroll navigation
---

<nav id="scroll-nav" class="fixed left-6 top-1/2 -translate-y-1/2 z-40 hidden lg:block">
    <!-- Navigation Container with backdrop -->
    <div class="nav-container backdrop-blur-sm bg-black/20 rounded-2xl p-4 border border-white/10">
        <ul class="space-y-6 text-sm">
            <!-- North Star Section -->
            <li class="nav-section">
                <a href="#north-star" class="nav-item nav-main flex items-center gap-3 group relative" data-section="north-star">
                    <span class="nav-label transition-all duration-300 font-medium text-white whitespace-nowrap">
                        North Star
                    </span>
                </a>
                <ul class="ml-6 mt-3 space-y-2 text-xs nav-subitems">
                    <li><a href="#our-events" class="nav-item nav-sub text-blue-300/60 hover:text-blue-400 transition-all duration-200 block py-1" data-section="our-events">Our Events</a></li>
                    <li><a href="#blog-posts" class="nav-item nav-sub text-blue-300/60 hover:text-blue-400 transition-all duration-200 block py-1" data-section="blog-posts">Blog Posts</a></li>
                    <li><a href="#team" class="nav-item nav-sub text-blue-300/60 hover:text-blue-400 transition-all duration-200 block py-1" data-section="team">Team</a></li>
                    <li><a href="#mission" class="nav-item nav-sub text-blue-300/60 hover:text-blue-400 transition-all duration-200 block py-1" data-section="mission">Mission</a></li>
                </ul>
            </li>

            <!-- NS Kids Section -->
            <li class="nav-section">
                <a href="#ns-kids" class="nav-item nav-main flex items-center gap-3 group relative" data-section="ns-kids">
                    <span class="nav-label transition-all duration-300 font-medium text-white whitespace-nowrap" style="font-family: 'More Sugar', cursive;">
                        NS Kids
                    </span>
                </a>
                <ul class="ml-6 mt-3 space-y-2 text-xs nav-subitems">
                    <li><a href="#kids-hackathon" class="nav-item nav-sub transition-all duration-200 block py-1 hover:translate-x-1" data-section="kids-hackathon" style="color: rgba(255, 213, 62, 0.6);">Hackathon</a></li>
                    <li><a href="#kids-mission" class="nav-item nav-sub transition-all duration-200 block py-1 hover:translate-x-1" data-section="kids-mission" style="color: rgba(255, 213, 62, 0.6);">Mission</a></li>
                </ul>
            </li>

            <!-- NS Robotics Section -->
            <li class="nav-section">
                <a href="#ns-robotics" class="nav-item nav-main flex items-center gap-3 group relative" data-section="ns-robotics">
                    <span class="nav-label transition-all duration-300 font-medium text-white whitespace-nowrap" style="font-family: 'VT323', monospace; letter-spacing: 0.05em;">
                        North Star Robotics
                    </span>
                </a>
                <ul class="ml-6 mt-3 space-y-2 text-xs nav-subitems" style="font-family: 'VT323', monospace;">
                    <li><a href="#robotics-funding" class="nav-item nav-sub transition-all duration-200 block py-1 hover:translate-x-1" data-section="robotics-funding" style="color: rgba(255, 182, 54, 0.6);">Funding</a></li>
                    <li><a href="#robotics-why" class="nav-item nav-sub transition-all duration-200 block py-1 hover:translate-x-1" data-section="robotics-why" style="color: rgba(255, 182, 54, 0.6);">Why</a></li>
                    <li><a href="#robotics-open" class="nav-item nav-sub transition-all duration-200 block py-1 hover:translate-x-1" data-section="robotics-open" style="color: rgba(255, 182, 54, 0.6);">Open</a></li>
                </ul>
            </li>
        </ul>

        <!-- Progress indicator -->
        <div class="absolute -right-1 top-0 bottom-0 w-1 bg-white/5 rounded-full overflow-hidden">
            <div id="scroll-progress" class="w-full bg-gradient-to-b from-blue-400 via-yellow-400 to-orange-400 transition-all duration-300" style="height: 0%; transform-origin: top;"></div>
        </div>
    </div>
</nav>

<style>
    /* Navigation container styling */
    .nav-container {
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        transition: all 0.3s ease;
    }

    .nav-container:hover {
        background: rgba(0, 0, 0, 0.4);
        border-color: rgba(255, 255, 255, 0.2);
    }

    /* Active state for main nav items */
    .nav-item.active.nav-main .nav-dot {
        background-color: white !important;
        transform: scale(1.4);
        box-shadow: 0 0 12px rgba(255, 255, 255, 0.6);
    }

    .nav-item.active.nav-main .nav-label {
        opacity: 1;
    }

    .nav-item.active.nav-main .nav-line {
        width: 40px;
    }

    /* Active state for subitems */
    .nav-item.active.nav-sub {
        color: white !important;
        font-weight: 600;
        transform: translateX(4px);
    }

    .nav-item.active.nav-sub::before {
        content: '▸ ';
        opacity: 1;
    }

    .nav-sub::before {
        content: '▸ ';
        opacity: 0;
        transition: opacity 0.2s ease;
    }

    .nav-sub:hover::before {
        opacity: 0.6;
    }

    /* Smooth section transitions */
    .nav-section {
        position: relative;
    }

    .nav-subitems {
        max-height: 0;
        overflow: hidden;
        opacity: 0;
        transition: all 0.3s ease;
    }

    .nav-section:hover .nav-subitems,
    .nav-section.active .nav-subitems {
        max-height: 200px;
        opacity: 1;
    }

    /* Dot pulse animation */
    @keyframes dot-pulse {
        0%, 100% {
            transform: scale(1);
            opacity: 1;
        }
        50% {
            transform: scale(1.2);
            opacity: 0.8;
        }
    }

    .nav-item.active .nav-dot {
        animation: dot-pulse 2s ease-in-out infinite;
    }
</style>

<script>
    // Enhanced navigation with scroll tracking
    const sections = document.querySelectorAll('[id]');
    const navItems = document.querySelectorAll('.nav-item');
    const navSections = document.querySelectorAll('.nav-section');
    const scrollProgress = document.getElementById('scroll-progress');

    function updateNavigation() {
        let current = '';
        const scrollY = window.scrollY;
        const windowHeight = window.innerHeight;
        const documentHeight = document.documentElement.scrollHeight;

        // Update scroll progress bar
        const scrollPercentage = (scrollY / (documentHeight - windowHeight)) * 100;
        if (scrollProgress) {
            scrollProgress.style.height = `${Math.min(scrollPercentage, 100)}%`;
        }

        // Find current section
        sections.forEach(section => {
            const sectionTop = section.offsetTop - 200;
            const sectionHeight = section.offsetHeight;

            if (scrollY >= sectionTop && scrollY < sectionTop + sectionHeight) {
                current = section.getAttribute('id') || '';
            }
        });

        // Update active states
        navItems.forEach(item => {
            item.classList.remove('active');
            const section = item.getAttribute('data-section');
            if (section === current) {
                item.classList.add('active');

                // Also activate parent section
                const parentSection = item.closest('.nav-section');
                if (parentSection) {
                    parentSection.classList.add('active');
                }
            }
        });

        // Remove active from sections not in current path
        navSections.forEach(section => {
            const mainLink = section.querySelector('.nav-main');
            const subLinks = section.querySelectorAll('.nav-sub');
            let hasActive = false;

            if (mainLink?.classList.contains('active')) {
                hasActive = true;
            }

            subLinks.forEach(subLink => {
                if (subLink.classList.contains('active')) {
                    hasActive = true;
                }
            });

            if (!hasActive) {
                section.classList.remove('active');
            }
        });
    }

    // Smooth scroll on click
    navItems.forEach(item => {
        item.addEventListener('click', (e) => {
            e.preventDefault();
            const targetId = item.getAttribute('href');
            if (targetId) {
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    targetElement.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            }
        });
    });

    // Throttled scroll handler
    let ticking = false;
    window.addEventListener('scroll', () => {
        if (!ticking) {
            requestAnimationFrame(() => {
                updateNavigation();
                ticking = false;
            });
            ticking = true;
        }
    });

    // Initial update
    updateNavigation();
</script>
